{% load static %}
<!DOCTYPE html>
<html>
<head>
  <title>Profit Dashboard</title>
  <link rel="stylesheet" href="{% static 'pos/style.css' %}">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<div class="topbar">
  <h2>ğŸ“Š Profit Dashboard</h2>
  <a href="{% url 'pos:dashboard' %}" class="btn dark">â¬… Back</a>
</div>

<!-- ğŸ”¥ KPI CARDS -->
<div class="grid2">
  <div class="card">
    <h3>ğŸ’° Todayâ€™s Sales</h3>
    <h1>â‚¹ {{ today_sales|floatformat:0 }}</h1>
  </div>

  <div class="card">
    <h3>ğŸ“† This Month</h3>
    <h1>â‚¹ {{ month_sales|floatformat:0 }}</h1>
  </div>
</div>

<!-- ğŸ“Š CHARTS -->
<div class="grid2">

  <div class="card">
    <h3>ğŸ·ï¸ Category Wise Revenue</h3>
    <canvas id="categoryChart"></canvas>
  </div>

  <div class="card">
    <h3>ğŸ”¥ Top Selling Items</h3>
    <canvas id="itemsChart"></canvas>
  </div>

</div>

<!-- ğŸ“‹ TABLES -->
<div class="grid2">

 <div style="width: 100%; height: 100%; margin:auto;">
  <canvas id="foodQtyChart"></canvas>
</div>


  <div class="card">
    <h3>ğŸ¥‡ Top Items</h3>
    <table class="table">
      <tr>
        <th>Item</th>
        <th>Revenue (â‚¹)</th>
      </tr>
      {% for i in top_items_qs %}
      <tr>
        <td>{{ i.item_name }}</td>
        <td>â‚¹ {{ i.total|floatformat:0 }}</td>
      </tr>
      {% endfor %}
    </table>
  </div>

</div>

<script>
/* CATEGORY CHART */
new Chart(document.getElementById("categoryChart"), {
  type: "bar",
  data: {
    labels: {{ categories|safe }},
    datasets: [{
      label: "Revenue (â‚¹)",
      data: {{ category_totals|safe }},
      backgroundColor: "#4CAF50"
    }]
  }
});

/* TOP ITEMS CHART */
new Chart(document.getElementById("itemsChart"), {
  type: "bar",
  data: {
    labels: {{ top_items|safe }},
    datasets: [{
      label: "Revenue (â‚¹)",
      data: {{ top_items_total|safe }},
      backgroundColor: "#ABDADC"
    }]
  },
  options: {
    indexAxis: 'y'
  }
});
</script>

<canvas id="foodQtyChart"></canvas>

<script>
new Chart(document.getElementById("foodQtyChart"), {
  type: "bar",
  data: {
    labels: {{ food_items|safe }},
    datasets: [{
      label: "Qty Sold",
      data: {{ food_quantities|safe }},
    }]
  }
});
</script>

</body>
</html>
